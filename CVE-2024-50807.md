https://github.com/trippo/ResponsiveFilemanager
- Vendor: trippo
- Product: ResponsiveFilemanager
- Version: 9.14.0
- Affected: Upload feature leading to stored XSS.
- Author: Shiv

This application is no longer maintained by the vendors but very few companies are still using it.

There is a stored xss via file upload using the svg and pdf extensions. This is affects other parts of the application too. 

```'ext_img'                                 => array( 'jpg', 'jpeg', 'png', 'gif', 'bmp', 'svg', 'ico' )``` 

This php code in config.php for images allows svg. However, pdf also works.
Another thing is that html upload directly is filtered with .txt by the app, whereas if you upload htmltest.svg with html code,
it'll treat it as .html and bypass that check.

This stored XSS lead to information disclosure of user cookies, name, useragent and IP.  

- Sanitise the code that's given as file, i.e, block javascript, php code directly to execute. Only allow image data to passthrough.
- Restrict the whitelist further.

## POC

https://github.com/user-attachments/assets/1b3d119f-2dd7-4a4c-a1f3-e00c18307a24

## References and Advisories 
- https://nvd.nist.gov/vuln/detail/CVE-2024-50807
- https://www.cve.org/CVERecord?id=CVE-2024-50807
- https://vulners.com/cve/CVE-2024-50807
- https://gist.github.com/HackShiv/4254db89214913867aa8dd5c1ec09b7e



